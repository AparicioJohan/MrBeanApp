<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Routine to fit several spatial models for Augmented, Unreplicated and P-Rep Designs — spatial.aud • MrBean</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Routine to fit several spatial models for Augmented, Unreplicated and P-Rep Designs — spatial.aud"><meta property="og:description" content="spatial.aud Generates a table with the goodness-of-fit statisitcs to select the
best spatial model for an analysis of an Augmented, Unreplicated or a P-Rep design.
The models fitted are: 1) independent errors, 2) spatial (ar1) in columns, 3) spatial (ar1)
in rows, and 4) spatial (ar1) in both rows and columns. If blocks are provided, these will
be fitted as random effects. Genotype (or treatment) effects can be specified as random or fixed.
If an additional factor of checks is provided then these will be fitted as fixed effects."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MrBean</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/AparicioJohan/MrBeanApp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Routine to fit several spatial models for Augmented, Unreplicated and P-Rep Designs</h1>
    <small class="dont-index">Source: <a href="https://github.com/AparicioJohan/MrBeanApp/blob/HEAD/R/asreml_funct.R" class="external-link"><code>R/asreml_funct.R</code></a></small>
    <div class="hidden name"><code>spatial.aud.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>spatial.aud</code> Generates a table with the goodness-of-fit statisitcs to select the
best spatial model for an analysis of an Augmented, Unreplicated or a P-Rep design.
The models fitted are: 1) independent errors, 2) spatial (ar1) in columns, 3) spatial (ar1)
in rows, and 4) spatial (ar1) in both rows and columns. If blocks are provided, these will
be fitted as random effects. Genotype (or treatment) effects can be specified as random or fixed.
If an additional factor of checks is provided then these will be fitted as fixed effects.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spatial.aud</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gen <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  check <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  block <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nugget <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  resp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type.gen <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>dataframe with all relevant columns for spatial model and response variables.</p></dd>


<dt>gen</dt>
<dd><p>factor name for genotypes (or treatments)</p></dd>


<dt>check</dt>
<dd><p>factor name for checks (labeled 'control') and test lines (labeled 'test') (optional)</p></dd>


<dt>block</dt>
<dd><p>factor name for block (or replicates) (optional)</p></dd>


<dt>row</dt>
<dd><p>factor name for row coordinates of each experimental unit</p></dd>


<dt>col</dt>
<dd><p>factor name for column coordinates of each experimental unit</p></dd>


<dt>covariate</dt>
<dd><p>factor for additional covariate (optional)</p></dd>


<dt>nugget</dt>
<dd><p>logical to fit nugget random effects (default = FALSE)</p></dd>


<dt>resp</dt>
<dd><p>column name for the response variable to analyze</p></dd>


<dt>type.gen</dt>
<dd><p>model assumption for genotypes: 'random' or 'fixed' (default = 'random')</p></dd>


<dt>model</dt>
<dd><p>model number to be fitted (optional)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A table with goodness-of-fit statistics for models evaluated. This includes columns:
number of variance components in the model (n.VC), log-likelihood (logL), Akaike information
criteria (AIC), Bayesian information criteria (BIC), heritability based on predictor
error variance (heritPEV, only for genotypes 'random'), A-optimality value, logarithm of
D-optimality value, and pvalue of comparison of each model against Independent Model based
on a likelihood ratio test (LRT).
If parameter model is specified an object with fitted model number is provided, together with
predictions for genotypes, here an additional column of 'weight' is incorporated to be used
on a second-stage analysis. These weights are the diagonal of the inverse of the variance-
covariance matrix of predictions.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Salvador A. Gezan. VSN International</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Analysis Unreplicated Trial</span></span></span>
<span class="r-in"><span><span class="co"># library(agridat)</span></span></span>
<span class="r-in"><span><span class="co"># UR &lt;- burgueno.unreplicated</span></span></span>
<span class="r-in"><span><span class="co"># UR$col &lt;- as.factor(UR$col)</span></span></span>
<span class="r-in"><span><span class="co"># UR$row &lt;- as.factor(UR$row)</span></span></span>
<span class="r-in"><span><span class="co"># UR$gen &lt;- as.factor(UR$gen)</span></span></span>
<span class="r-in"><span><span class="co"># head(UR)</span></span></span>
<span class="r-in"><span><span class="co"># output.UR &lt;- spatial.aud(data=UR, gen='gen', row='row', col='col', resp='yield',</span></span></span>
<span class="r-in"><span><span class="co">#                          type.gen='random')</span></span></span>
<span class="r-in"><span><span class="co"># output.UR</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># # Example 2: Fitting only Model 4: ar1(Row):ar1(Col)</span></span></span>
<span class="r-in"><span><span class="co"># mod4.UR &lt;- spatial.aud(data=UR, gen='gen', row='row', col='col', resp='yield',</span></span></span>
<span class="r-in"><span><span class="co">#                        type.gen='random', model=4)</span></span></span>
<span class="r-in"><span><span class="co"># summary(mod4.UR$mod)$varcomp  # Summary from ASReml-R</span></span></span>
<span class="r-in"><span><span class="co"># head(mod4.UR$predictions)     # Predictions</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Johan Aparicio.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

