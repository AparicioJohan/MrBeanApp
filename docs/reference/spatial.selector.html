<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Routine to fit several spatial models and suggest the best model — spatial.selector • MrBean</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Routine to fit several spatial models and suggest the best model — spatial.selector"><meta property="og:description" content="spatial.selector Generates a table with the goodness-of-fit statitics to select the
best spatial model for an analysis of different analyses (unreplicated and replicated).
Models that can not fit are reported as NA.
The models require some input conditions from user: 1) Genotypes: fixed/random; 2)	Blocks:
TRUE/FALSE (if TRUE then fixed/random); 3) Covariates (always fixed, max 2); and 4)
Incomplete Blocks: TRUE/FALSE (always random).
The model selector will run over a series of models with the conditions: 1) Rows within
replicate: TRUE/FALSE (always random); 2) Columns within replicate: TRUE/FALSE (always
random); 3) Spline on rows: TRUE/FALSE (fixed linear covariate + random spline); 4) Spline
on columns: TRUE/FALSE (fixed linear covariate + random spline); and 5) Residual structure:
'indep' or 'ar1'. In addition the best spatial model (with ar1) and selected according to
A-optimality is fitted with an additional nugget effect. List of 32 models is found on data
MODLIST.Rda."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MrBean</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/AparicioJohan/MrBeanApp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Routine to fit several spatial models and suggest the best model</h1>
    <small class="dont-index">Source: <a href="https://github.com/AparicioJohan/MrBeanApp/blob/HEAD/R/ASReml_single.R" class="external-link"><code>R/ASReml_single.R</code></a></small>
    <div class="hidden name"><code>spatial.selector.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>spatial.selector</code> Generates a table with the goodness-of-fit statitics to select the
best spatial model for an analysis of different analyses (unreplicated and replicated).
Models that can not fit are reported as NA.
The models require some input conditions from user: 1) Genotypes: fixed/random; 2)	Blocks:
TRUE/FALSE (if TRUE then fixed/random); 3) Covariates (always fixed, max 2); and 4)
Incomplete Blocks: TRUE/FALSE (always random).
The model selector will run over a series of models with the conditions: 1) Rows within
replicate: TRUE/FALSE (always random); 2) Columns within replicate: TRUE/FALSE (always
random); 3) Spline on rows: TRUE/FALSE (fixed linear covariate + random spline); 4) Spline
on columns: TRUE/FALSE (fixed linear covariate + random spline); and 5) Residual structure:
'indep' or 'ar1'. In addition the best spatial model (with ar1) and selected according to
A-optimality is fitted with an additional nugget effect. List of 32 models is found on data
MODLIST.Rda.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spatial.selector</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gen <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  block <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ibk <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cov1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cov2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  resp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type.gen <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  type.block <span class="op">=</span> <span class="st">"fixed"</span>,</span>
<span>  nugget <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>dataframe with all relevant columns for spatial model and response variables.</p></dd>


<dt>gen</dt>
<dd><p>factor name for genotypes (or treatments)</p></dd>


<dt>block</dt>
<dd><p>factor name for full block (or replicates) (optional)</p></dd>


<dt>ibk</dt>
<dd><p>factor name for incomplete block (optional) (optional)</p></dd>


<dt>row</dt>
<dd><p>column name for row coordinates of each experimental unit</p></dd>


<dt>col</dt>
<dd><p>column name for column coordinates of each experimental unit</p></dd>


<dt>cov1</dt>
<dd><p>column name with additional covariate 1 (optional)</p></dd>


<dt>cov2</dt>
<dd><p>column name with additional covariate 2 (optional)</p></dd>


<dt>resp</dt>
<dd><p>column name for the response variable to analyze</p></dd>


<dt>type.gen</dt>
<dd><p>model assumption for genotypes: 'random' or 'fixed' (default: 'random')</p></dd>


<dt>type.block</dt>
<dd><p>model assumption for full blocks: 'random' or 'fixed' (default: 'fixed')</p></dd>


<dt>nugget</dt>
<dd><p>logical to add nugget to any spatial model fitted (dafualt: FALSE)</p></dd>


<dt>model</dt>
<dd><p>model number to be fitted (optional)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A table with goodness-of-fit statistics for models evaluated. This includes columns:
   number of variance components in the model (n.VC), log-likelihood (logL), Akaike information
   criteria (AIC), Bayesian information criteria (BIC), and heritability based on predictor
   error variance (heritPEV, only for genotypes 'random').</p>


<p>If parameter 'model' is specified the object with fitted model number is provided, with
   several objects with details of the fitted model.</p>


<p>aov:         Wald-test (mixed model ANOVA-like table)
   call:        String with the ASReml-R call used to fit the requested model
   gt:          Goodness-of-fit statistics for the model evaluated are reported as summary. This includes columns:
                 number of variance components in the model (n.VC), log-likelihood (logL), Akaike information
                 criteria (AIC), Bayesian information criteria (BIC), A-optimality value, logarithm of the
                 D-optimality value, and heritability based on predictor error variance (heritPEV, only for
                 genotypes 'random')
   mod:         ASReml-R object with all information from the fitted model
   predictions: Predictions for all genotypes, with an additional column of 'weight' is to be used on a
                 on a second-stage analysis. These weights are the diagonal of the inverse of the variance-
                 covariance matrix of predictions</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Salvador A. Gezan. VSN International</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Selecting best model from Replicated Trial</span></span></span>
<span class="r-in"><span><span class="co"># library(agridat)</span></span></span>
<span class="r-in"><span><span class="co"># testREP &lt;- durban.rowcol</span></span></span>
<span class="r-in"><span><span class="co"># testREP$bed &lt;- as.factor(testREP$bed)</span></span></span>
<span class="r-in"><span><span class="co"># testREP$row &lt;- as.factor(testREP$row)</span></span></span>
<span class="r-in"><span><span class="co"># testREP$gen &lt;- as.factor(testREP$gen)</span></span></span>
<span class="r-in"><span><span class="co"># head(testREP)</span></span></span>
<span class="r-in"><span><span class="co"># test.sel &lt;- spatial.selector(data=testREP, gen='gen', row='row', col='bed',</span></span></span>
<span class="r-in"><span><span class="co">#                              resp='yield', type.gen='random')</span></span></span>
<span class="r-in"><span><span class="co"># View(test.sel$parms)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># # Example 2: Fitting only selected model 27</span></span></span>
<span class="r-in"><span><span class="co"># mod.sel &lt;- spatial.selector(data=testREP, gen='gen', row='row', col='bed',</span></span></span>
<span class="r-in"><span><span class="co">#                              resp='yield', type.gen='random', model=27)</span></span></span>
<span class="r-in"><span><span class="co"># ls(mod.sel)</span></span></span>
<span class="r-in"><span><span class="co"># mod.sel$call                  # Call for model fitted</span></span></span>
<span class="r-in"><span><span class="co"># plot(mod.sel$mod)             # Residual plots</span></span></span>
<span class="r-in"><span><span class="co"># plot(varioGram(mod.sel$mod))  # Variogram fitted model</span></span></span>
<span class="r-in"><span><span class="co"># summary(mod.sel$mod)$varcomp  # Variance Components</span></span></span>
<span class="r-in"><span><span class="co"># mod.sel$aov                   # Wald-test Table</span></span></span>
<span class="r-in"><span><span class="co"># mod.sel$gt$herit.PEV          # Heritability (other statistics on gt)</span></span></span>
<span class="r-in"><span><span class="co"># head(mod.sel$predictions)     # Predictions for fitted model with additional weights</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Johan Aparicio.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

